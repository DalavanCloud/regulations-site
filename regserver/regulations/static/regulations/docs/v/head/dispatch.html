<!DOCTYPE html>

<html>
<head>
  <title>dispatch.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="app-init.html">
                app-init.js
              </a>
            
              
              <a class="source" href="build.html">
                build.js
              </a>
            
              
              <a class="source" href="dispatch.html">
                dispatch.js
              </a>
            
              
              <a class="source" href="helpers.html">
                helpers.js
              </a>
            
              
              <a class="source" href="regulations.html">
                regulations.js
              </a>
            
              
              <a class="source" href="require.config.html">
                require.config.js
              </a>
            
              
              <a class="source" href="router.html">
                router.js
              </a>
            
              
              <a class="source" href="analytics-handler-view.html">
                analytics-handler-view.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>dispatch.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p><strong>Extends</strong> Backbone.Events</p>
<p><strong>Usage</strong> require([&#39;dispatch&#39;], function(Dispatch) {}))</p>
<p><strong>Dispatch:</strong>
Verb: 
<em> 1. Send off to a destination or for a purpose.
</em> 2. Deal with a task quickly and efficiently</p>
<p>Noun: The sending of someone or something to a destination or for a purpose.</p>
<p>Dispatch is responsible, via Backbone.Events, for, appropriately, dispatching event triggers and notifying bindings
There are entities that, at first glance, would seem to have a straightforward parent/child relationship with another module
However, there are significant interactions that occur across two or more modules. Instead of having a complicated 
multi-event scheme or introducing a lot of coupling between modules, Dispatch can house and serve information about these entities.</p>
<p>Example: inline definitions. They are triggered by a link in reg-view, can be closed by reg-view, sidebar-head-view or sidebar-view.
Closing a definition without introducing multiple events or causing cyclical dependencies can be tricky. If the definition View instance belongs
to any of these modules, another module will need to as the parent module directly for information about the View instance. Instead, all
modules can remove the open definition by calling <code>Dispatch.remove(&#39;definition&#39;);</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>define(<span class="string">'dispatch'</span>, [<span class="string">'jquery'</span>, <span class="string">'underscore'</span>, <span class="string">'backbone'</span>], <span class="keyword">function</span>($, _, Backbone) {
    <span class="string">'use strict'</span>;
    <span class="keyword">var</span> Dispatch = _.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>storage for entities
<strong>Usage</strong> Dispatch.open.definition
idea is that each entity will be stored according to its type so that any module can refer to it without knowing what
instance it holds. 
This scheme currently limits it to one value associated with each type, in theory.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        open: {},

        state: {},</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>store a new entity in Dispatch.open
<strong>Params</strong></p>
<ul>
<li><strong>key</strong>, string, entity type, ex. &#39;definition&#39;</li>
<li><strong>val</strong>, object, new Backbone View</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>        set: <span class="keyword">function</span>(key, val) {
            <span class="keyword">this</span>.open[key] = val;
        },

        trigger: <span class="keyword">function</span>(name) {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>var events: {
    &#39;content:loading&#39;: {
         &#39;args&#39;: { 
             &#39;id&#39;: &#39;unique id ex. 123-4&#39;,
         },
         &#39;usage&#39;: &#39;to update state and block subsequent requests until current request is resolved&#39;
     },
     &#39;content:loaded&#39;: {
         &#39;usage&#39;: &#39;to update state and unblock new requests from occurring&#39;
     },
     &#39;mode:change&#39;: {
         &#39;args&#39;: {
             &#39;id&#39;: &#39;open content in new mode&#39;,
             &#39;type&#39;: &#39;new mode changed to. should correspond with this.state[&quot;mode&quot;]&#39;
         }
         &#39;usage&#39;: &#39;to prompt views to make alterations based on the new state
     },
     &#39;definition:remove&#39;: {
         &#39;args&#39;: {
             &#39;id&#39;: &#39;def reg section id&#39;
         },
         &#39;usage&#39;: &#39;remove active key term in body, remove sidebar header&#39;
     }
     &#39;ga-event:?&#39;: {
         &#39;?&#39;: &#39;event to be sent to Google Analytics&#39;
     }</p>
<p>};</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">var</span> listenTo = {
                <span class="string">'content:loaded'</span>: <span class="keyword">this</span>.setActivityStatus,
                <span class="string">'content:loading'</span>: <span class="keyword">this</span>.setActivityStatus,
                <span class="string">'mode:change'</span>: <span class="keyword">this</span>.setUIMode
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>like an event listener, calls
&quot;bound&quot; method in <code>listenTo</code> based
on current event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">if</span> (listenTo.hasOwnProperty[name]) {
                listenTo[name](arguments);
            }

            <span class="comment">/* jshint camelcase: false */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>call parent <code>trigger()</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            Dispatch.__super__.trigger.apply(<span class="keyword">this</span>, name); 
        },

        removeContentView: <span class="keyword">function</span>() {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.open[<span class="string">'contentView'</span>] !== <span class="string">'undefined'</span>) {
                <span class="keyword">this</span>.open[<span class="string">'contentView'</span>].remove();
                <span class="keyword">delete</span>(<span class="keyword">this</span>.open[<span class="string">'contentView'</span>]);
            }
        },

        setContentView: <span class="keyword">function</span>(view) {
            <span class="keyword">this</span>.set(<span class="string">'contentView'</span>, view);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>remove a value from Dispatch.open and call its <code>remove()</code> method
<strong>Param</strong> string, entity type, ex. &#39;definition&#39;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        remove: <span class="keyword">function</span>(key) {
            <span class="keyword">if</span> (<span class="keyword">this</span>.open[key]) {
                <span class="keyword">this</span>.open[key].remove();
                <span class="keyword">delete</span>(<span class="keyword">this</span>.open[key]);
            }
        },

        hasPushState: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.state[<span class="string">'pushState'</span>];
        },

        setState: <span class="keyword">function</span>(state) {
            <span class="keyword">this</span>.state[<span class="string">'pushState'</span>] = state;
        },

        getUIMode: <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>var options = [&#39;regSection&#39;, &#39;breakaway&#39;, &#39;search&#39;, &#39;diff&#39;, &#39;history&#39;];</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">return</span> <span class="keyword">this</span>.state[<span class="string">'mode'</span>];
        },

        setUIMode: <span class="keyword">function</span>(context) {
            <span class="keyword">this</span>.state[<span class="string">'mode'</span>] = context.type;
        },

        getActivityStatus: <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>var options = [&#39;standby&#39;, &#39;init&#39;, &#39;loading&#39;];</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">return</span>(<span class="keyword">this</span>.state[<span class="string">'activity'</span>] || <span class="string">'standby'</span>);   
        },

        setActivityStatus: <span class="keyword">function</span>(context) {
            <span class="keyword">this</span>.state[<span class="string">'activity'</span>] = context.type;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>retrieve the id of the stored object
<strong>Param</strong> string, entity type, ex. &#39;definition&#39;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        getViewId: <span class="keyword">function</span>(type) {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.open[type] === <span class="string">'object'</span>) {
                <span class="keyword">return</span> <span class="keyword">this</span>.open[type].id;
            }
            <span class="keyword">return</span> <span class="literal">false</span>;
        },

        getDrawerState: <span class="keyword">function</span>() {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.open[<span class="string">'drawerState'</span>] !== <span class="string">'undefined'</span>) {
                <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'drawerState'</span>];
            }
            <span class="keyword">else</span> {
                <span class="keyword">return</span> <span class="literal">false</span>;
            }
        },

        get: <span class="keyword">function</span>(item) {
            <span class="keyword">return</span> <span class="keyword">this</span>.open[item];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>return open section ex. 1005-3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        getOpenSection: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'section'</span>]; 
        },

        getVersion: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'version'</span>];
        },

        getURLPrefix: <span class="keyword">function</span>() {
            <span class="keyword">if</span> (<span class="keyword">this</span>.open[<span class="string">'urlprefix'</span>]) {
                <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'urlprefix'</span>];
            }
            <span class="keyword">else</span> {
                <span class="keyword">return</span> <span class="literal">false</span>;
            }
        },

        getRegId: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'reg'</span>];
        },

        getContentView: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.open[<span class="string">'contentView'</span>];
        }

    }, Backbone.Events);   

    <span class="keyword">return</span> Dispatch;
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
